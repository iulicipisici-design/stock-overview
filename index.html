<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THUND3R STORE | Stock Overview</title>
<style>
  /* ... (pƒÉstreazƒÉ stilurile tale existente) ... */
</style>
</head>
<body>

<div class="navbar">
  <div class="logo" id="logo">THUND3R STORE | Boost Bot</div>
  <div class="nav-buttons">
    <button class="nav-btn purple" id="adminBtn">Admin Panel</button>
    <button class="nav-btn green" id="buyBtn">Buy Boost</button>
  </div>
</div>

<div class="admin-indicator" id="adminIndicator">
  <div class="pulse-dot"></div>
  <span>Admin Active</span>
</div>

<h1>Stock Overview</h1>
<div class="updated">Last updated: <span id="time"></span></div>

<div class="cards">
  <div class="card" data-product="1month">
    <img src="https://cdn-icons-png.flaticon.com/512/565/565547.png" width="40" alt="">
    <h2>Server Boosts (1 Month)</h2>
    <div class="stock" contenteditable="false">0</div>
    <div class="status in-stock">üü¢ IN STOCK</div>
  </div>

  <div class="card" data-product="3months">
    <img src="https://cdn-icons-png.flaticon.com/512/833/833472.png" width="40" alt="">
    <h2>Server Boosts (3 Months)</h2>
    <div class="stock" contenteditable="false">0</div>
    <div class="status low-stock">üü† LOW STOCK</div>
  </div>
</div>

<button class="refresh" id="refreshBtn">üîÑ Refresh Stock</button>

<script>
const cards = document.querySelectorAll(".card");
const adminBtn = document.getElementById("adminBtn");
const refreshBtn = document.getElementById("refreshBtn");
const buyBtn = document.getElementById("buyBtn");
const timeEl = document.getElementById("time");
const adminIndicator = document.getElementById("adminIndicator");
let adminMode = false;

const STOCK_URL = "http://localhost:8080/stock-proxy"; // folose»ôte proxy-ul

function updateTime() {
  timeEl.textContent = new Date().toLocaleTimeString();
}
updateTime();
setInterval(updateTime, 1000);

// Admin login/logout
adminBtn.addEventListener("click", () => {
  if (!adminMode) {
    const pass = prompt("üîê Introdu parola admin:");
    if (pass === "admin123") {
      adminMode = true;
      adminBtn.textContent = "üü¢ Admin Mode ON";
      cards.forEach(card => card.querySelector(".stock").setAttribute("contenteditable", "true"));
      adminIndicator.style.display = "flex";
      showToast("‚úÖ Modul ADMIN activat!");
    } else {
      showToast("‚ùå ParolƒÉ gre»ôitƒÉ!");
    }
  } else {
    adminMode = false;
    adminBtn.textContent = "Admin Panel";
    cards.forEach(card => card.querySelector(".stock").setAttribute("contenteditable", "false"));
    adminIndicator.style.display = "none";
    showToast("üîí Modul ADMIN dezactivat!");
  }
});

// Salvare stoc local
cards.forEach(card => {
  const stock = card.querySelector(".stock");
  stock.addEventListener("blur", () => {
    if (!adminMode) return;
    const value = stock.textContent.trim();
    if (!isNaN(value)) {
      localStorage.setItem(card.dataset.product, value);
      updateStatus(card, value);
      showToast("üíæ Stoc salvat!");
    } else {
      showToast("‚ö†Ô∏è Introdu doar numere!");
    }
  });
});

// Buy Boost
buyBtn.addEventListener("click", () => {
  window.open("https://thund3r-store.mysellauth.com/", "_blank");
});

// Preluare stoc prin proxy
async function fetchStock() {
  try {
    const response = await fetch(STOCK_URL);
    const text = await response.text();

    // Extragem primele douƒÉ numere din text
    const matches = text.match(/\d+/g);
    if (!matches || matches.length < 2) throw new Error("Nu s-au gƒÉsit stocurile");

    cards.forEach((card, i) => {
      const value = matches[i];
      card.querySelector(".stock").textContent = value;
      updateStatus(card, value);
    });

    showToast("‚úÖ Stoc actualizat!");
  } catch (err) {
    console.error(err);
    showToast("‚ùå Nu s-a putut prelua stocul!");
  }
}

refreshBtn.addEventListener("click", fetchStock);
window.addEventListener("load", fetchStock);

function updateStatus(card, value) {
  const num = parseInt(value);
  const status = card.querySelector(".status");
  if (num <= 0) {
    status.textContent = "üî¥ OUT OF STOCK";
    status.className = "status out-stock";
  } else if (num <= 20) {
    status.textContent = "üü† LOW STOCK";
    status.className = "status low-stock";
  } else {
    status.textContent = "üü¢ IN STOCK";
    status.className = "status in-stock";
  }
}

function showToast(msg) {
  const toast = document.createElement("div");
  toast.className = "toast";
  toast.textContent = msg;
  document.body.appendChild(toast);
  setTimeout(() => toast.remove(), 2500);
}
</script>
</body>
</html>
